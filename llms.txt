# Ecological trajectory analysis

[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/ecotraj)](https://cran.r-project.org/package=ecotraj)
[![](https://cranlogs.r-pkg.org/badges/ecotraj)](https://cran.rstudio.com/web/packages/ecotraj/index.html)
[![R-CMD-check](https://github.com/emf-creaf/ecotraj/workflows/R-CMD-check/badge.svg)](https://github.com/emf-creaf/ecotraj/actions)

## Introduction

Package `ecotraj` is a package providing Ecological Trajectory Analysis
(ETA), a framework to analyse temporal changes (i.e. dynamics) in
ecological entities defined as trajectories on a chosen multivariate
space.

ETA is related to the following publications:

- Initial presentation of the **Ecological Trajectory Analysis (ETA)**
  framework (De Cáceres et al. 2019).

- ETA extension of **metrics** and **visualisation modes** (Sturbois et
  al. 2021a).

- ETA extension to **cyclical** trajectory data (Djeghri et al. under
  review).

- Interpretation of trajectory **relative movements** (Djeghri et al. in
  prep.).

- Application to a multivariate space defined by **stable isotope** data
  (Sturbois et al. 2021b).

- Application to a multivariate space defined by **elemental
  composition** data (de la Casa et al. 2025).

- Application of ETA framework for the **assessment of ecological
  quality** (Sturbois et al. 2023).

## Package installation

Package `ecotraj` can be found at
[CRAN](https://cran.r-project.org/package=ecotraj). In addition, the
latest stable `ecotraj` R package can also be installed from GitHub as
follows:

``` r
remotes::install_github("emf-creaf/ecotraj")
```

## Documentation and training

- The package comes with function documentation including examples.

- Several articles explaining the different metrics of the framework and
  how to conduct them using package functions can be found
  [here](https://emf-creaf.github.io/ecotraj/articles/).

- Presentation slides of a course on ecological trajectory analysis can
  be found [here](https://emf.creaf.cat/training/ecotraj_course/).

## Package functions

The following lists the main package functions, grouped by analysis
framework:

**Functions for Ecological Trajectory Analysis (ETA)**

| Name | Short description |
|----|----|
| [`defineTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/defineTrajectories.md) | Defines trajectory objects to be analyzed. |
| [`subsetTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/subsetTrajectories.md) | Subsets trajectories corresponding to selected set of sites or surveys from a dataset containing multiple trajectories. |
| [`trajectoryLengths()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Calculates lengths of directed segments and total path length of trajectories. |
| [`trajectoryLengths2D()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Calculates lengths of directed segments and total path lengths of trajectories from 2D coordinates given as input. |
| [`trajectorySpeeds()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Calculates speeds of directed segments and total path speed of trajectories. |
| [`trajectorySpeeds2D()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Calculates speeds of directed segments and total path speed of trajectories from 2D coordinates given as input. |
| [`trajectoryAngles()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points. |
| [`trajectoryDirectionality()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Assesses the level directionality of each trajectory. |
| [`trajectoryAngles2D()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Calculates the angle between consecutive pairs of directed segments or between segments of ordered triplets of points from 2D coordinates. |
| [`trajectoryConvergence()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md) | Performs the Mann-Kendall trend test on (1) the distances between trajectories; (2) the distance between points of one trajectory to the other; or (3) the variance of states among trajectories. |
| [`trajectoryCorrespondence()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md) | Performs a permutation test of pairwise dynamic correspondence between trajectories sensitive to trajectory shape and movement direction. |
| [`trajectoryRMA()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryRMA.md) | Tests and qualifies the relative movements of ecological trajectories. |
| [`trajectoryInternalVariation()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Assesses the internal variability within each trajectory. |
| [`trajectoryDistances()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md) | Estimates distances between pairs of ecosystem trajectories. |
| [`trajectoryShifts()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md) | Calculates trajectory shifts (i.e. advances and delays) between trajectories assumed to follow a similar path but with different speeds or time lags. |
| [`trajectoryPlot()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryPlot.md) | Draws trajectories in a 2D-plot corresponding to the input coordinates. |
| [`trajectoryPCoA()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryPlot.md) | Performs principal coordinates analysis and draws trajectories in the ordination scatterplot. |
| [`trajectoryMetrics()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Calculates several (whole path) metrics on trajectories. |
| [`trajectoryWindowMetrics()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md) | Calculates several metrics on subtrajectories defined using moving windows. |
| [`dynamicVariation()`](https://emf-creaf.github.io/ecotraj/reference/dynamicVariation.md) | Assesses the amount of dynamic variation observed across trajectories and the relative contribution of each of them. |
| [`interpolateTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/transformTrajectories.md) | Relocates trajectory ecological states to those corresponding to input times, via linear interpolation. |
| [`smoothTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/transformTrajectories.md) | Performs multivariate smoothing on trajectory data using a Gaussian kernel. |
| [`centerTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/transformTrajectories.md) | Shifts all trajectories to the center of the multivariate space and returns a modified distance matrix. |

**Functions specific for Cyclical Ecological Trajectory Analysis
(CETA)**

| Name | Short description |
|----|----|
| [`extractCycles()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md) | Extracts (i.e. subsets) cycles from cyclical trajectories. |
| [`extractFixedDateTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md) | Extracts fixed-date trajectories from cyclical trajectories. |
| [`cycleShifts()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md) | Estimates cyclical shifts (i.e. advances or delays). |
| [`cycleConvexity()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md) | Estimates the degree of convexity of cycles. |
| [`cycleMetrics()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md) | Calculates several (whole path) metrics on cycles. |
| [`cyclePCoA()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclicalPlots.md) | Performs Principal Coordinates Analysis and draws cycles in the ordination scatter plot. |
| [`fixedDateTrajectoryPCoA()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclicalPlots.md) | Performs Principal Coordinates Analysis and draws fixed date trajectories in the ordination scatter plot. |

**Functions for Ecological Quality Assessment (EQA)**

| Name | Short description |
|----|----|
| [`stateEnvelopeVariability()`](https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.md) | Assess the variability of a set of *states* taken as reference envelope. |
| [`trajectoryEnvelopeVariability()`](https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.md) | Assess the variability of a set of *trajectories* taken as reference envelope. |
| [`compareToStateEnvelope()`](https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.md) | Evaluate the ecological quality of stations/observations with respect to a set of *states* taken as reference envelope. |
| [`compareToTrajectoryEnvelope()`](https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.md) | Evaluate the ecological quality of stations/observations with respect to a set of *trajectories* taken as reference envelope. |

## Related package

The R package [**ecoregime**](https://mspinillos.github.io/ecoregime/),
by Martina Sánchez-Pinillos, implements the Ecological Dynamic Regimes
(EDR) framework to characterize and compare groups of ecological
trajectories in multidimensional spaces defined by ecosystem state
variables.

## References

- De Cáceres M, Coll L, Legendre P, Allen RB, Wiser SK, Fortin MJ,
  Condit R & Hubbell S (2019). Trajectory analysis in community ecology.
  Ecological Monographs 89, e01350 (<https://doi.org/10.1002/ecm.1350>).

- de la Casa J, Nogué S, De Cáceres M, Pla-Rabés S, Sardans J, Benavente
  M, Giralt S, Hernandez A, Raposeiro PM & Peñuelas J (2025)
  Understanding two millenia ecosystem perturbations on the Azores
  archipelago through elementome trajectories. Ecological Indicators,
  176, 113630 (<https://doi.org/10.1016/j.ecolind.2025.113630>).

- Djeghri et al (under review) Going round in cycles but going
  somewhere: Deciphering cyclical dynamics using Ecological Trajectory
  Analysis.

- Djeghri et al. (in preparation) Uncovering the relative movements of
  ecological trajectories.

- Sturbois A, De Cáceres M, Sánchez-Pinillos M, Schaal G, Gauthier O, Le
  Mao P, Ponsero A, & Desroy N (2021a). Extending community trajectory
  analysis : New metrics and representation. Ecological Modelling, 440,
  109400 (<https://doi.org/10.1016/j.ecolmodel.2020.109400>).

- Sturbois A, Cucherousset J, De Cáceres M, Desroy N, Riera P,
  Carpentier A, Quillien N, Grall J, Espinasse B, Cherel Y & Schaal G
  (2021). Stable Isotope Trajectory Analysis (SITA) : A new approach to
  quantify and visualize dynamics in stable isotope studies. Ecological
  Monographs, 92, e1501 (<https://doi.org/10.1002/ecm.1501>).

- Sturbois A, De Cáceres M, Bifolchi A, Bioret F, Boyé A, Gauthier O,
  Grall J, Grémare A, Labrune C, Robert A, Schaal G & Desroy N (2023).
  Ecological Quality Assessment: a general multivariate framework to
  report the quality of ecosystems and their dynamics with respect to
  reference conditions. Ecosphere 14, e4726
  (<https://doi.org/10.1002/ecs2.4726>).

# Package index

## Datasets

Example datasets

- [`avoca`](https://emf-creaf.github.io/ecotraj/reference/avoca.md)
  [`avoca_sites`](https://emf-creaf.github.io/ecotraj/reference/avoca.md)
  [`avoca_strat`](https://emf-creaf.github.io/ecotraj/reference/avoca.md)
  [`avoca_surveys`](https://emf-creaf.github.io/ecotraj/reference/avoca.md)
  : Avoca permanent plot dataset
- [`furseals`](https://emf-creaf.github.io/ecotraj/reference/furseals.md)
  : furseals dataset
- [`pike`](https://emf-creaf.github.io/ecotraj/reference/pike.md) : pike
  dataset
- [`heatmapdata`](https://emf-creaf.github.io/ecotraj/reference/heatmapdata.md)
  : heatmapdata dataset
- [`isoscape`](https://emf-creaf.github.io/ecotraj/reference/isoscape.md)
  : isoscape dataset
- [`glomel`](https://emf-creaf.github.io/ecotraj/reference/glomel.md) :
  Glomel vegetation dataset
- [`glenan`](https://emf-creaf.github.io/ecotraj/reference/glenan.md) :
  Glenan dataset
- [`northseaZoo`](https://emf-creaf.github.io/ecotraj/reference/northseaZoo.md)
  : North Sea zooplankton dataset

## Trajectory data

Set of functions to define and subset trajectories

- [`defineTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/defineTrajectories.md)
  : Trajectory definition
- [`subsetTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/subsetTrajectories.md)
  : Trajectory subsetting

## Trajectory metrics

Set of functions to calculate trajectory metrics

- [`trajectoryLengths()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectoryLengths2D()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectorySpeeds()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectorySpeeds2D()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectoryAngles()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectoryAngles2D()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectoryDirectionality()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectoryInternalVariation()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectoryMetrics()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  [`trajectoryWindowMetrics()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryMetrics.md)
  : Trajectory metrics

## Trajectory comparison

Set of functions to compare trajectories

- [`trajectoryProjection()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryProjection.md)
  : Trajectory projection
- [`segmentDistances()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md)
  [`trajectoryDistances()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md)
  [`trajectoryConvergence()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md)
  [`trajectoryCorrespondence()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md)
  [`trajectoryShifts()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryComparison.md)
  : Trajectory comparison
- [`trajectoryRMA()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryRMA.md)
  : Relative Trajectory Movement Assessment (RTMA)
- [`trajectoryRMAPlot()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryRMAPlot.md)
  : Heat map-like plots for Relative Trajectory Movement Assessment
  (RTMA)
- [`dynamicVariation()`](https://emf-creaf.github.io/ecotraj/reference/dynamicVariation.md)
  [`variationDecomposition()`](https://emf-creaf.github.io/ecotraj/reference/dynamicVariation.md)
  : Dynamic variation and variation decomposition

## Cyclical trajectory analysis

Set of functions for cyclical trajectory analysis

- [`extractCycles()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md)
  [`extractFixedDateTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md)
  [`cycleConvexity()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md)
  [`cycleShifts()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md)
  [`cycleMetrics()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclical.md)
  : Functions for Cyclical Ecological Trajectory Analysis

## Trajectory plots

Set of plotting functions

- [`trajectoryPCoA()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryPlot.md)
  [`trajectoryPlot()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryPlot.md)
  : Trajectory plots
- [`cyclePCoA()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclicalPlots.md)
  [`fixedDateTrajectoryPCoA()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryCyclicalPlots.md)
  : Cyclical trajectory plots
- [`trajectoryConvergencePlot()`](https://emf-creaf.github.io/ecotraj/reference/trajectoryConvergencePlot.md)
  : Summary plot for trajectory convergence and divergence
- [`cycleShiftArrows()`](https://emf-creaf.github.io/ecotraj/reference/cycleShiftArrows.md)
  : Displaying cycle shifts

## Ecological Quality Assessment

Set of functions to determine the membership to state/trajectory
envelopes

- [`trajectoryEnvelopeVariability()`](https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.md)
  [`stateEnvelopeVariability()`](https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.md)
  [`compareToTrajectoryEnvelope()`](https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.md)
  [`compareToStateEnvelope()`](https://emf-creaf.github.io/ecotraj/reference/referenceEnvelopes.md)
  : Ecological quality assessment

## Transform functions

Transforming trajectories

- [`smoothTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/transformTrajectories.md)
  [`centerTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/transformTrajectories.md)
  [`interpolateTrajectories()`](https://emf-creaf.github.io/ecotraj/reference/transformTrajectories.md)
  : Transform trajectories

## Miscellaneous

Miscellaneous functions

- [`is.metric()`](https://emf-creaf.github.io/ecotraj/reference/is.metric.md)
  : Metricity
- [`is.synchronous()`](https://emf-creaf.github.io/ecotraj/reference/is.synchronous.md)
  : Synchronicity in trajectory observations

# Articles

### Ecological Trajectory Analysis

- [Introduction to Ecological Trajectory Analysis
  (ETA)](https://emf-creaf.github.io/ecotraj/articles/IntroductionETA.md):
- [Transforming
  trajectories](https://emf-creaf.github.io/ecotraj/articles/TransformingTrajectories.md):
- [Distance metrics for trajectory
  resemblance](https://emf-creaf.github.io/ecotraj/articles/TrajectoryDistanceMetrics.md):
- [Dissimilarities in community
  data](https://emf-creaf.github.io/ecotraj/articles/Dissimilarities.md):

### Stable Isotope Trajectory Analysis

- [Stable Isotope Trajectory Analysis
  (SITA)](https://emf-creaf.github.io/ecotraj/articles/SITA.md):

### Cyclical Ecological Trajectory Analysis

- [Introduction to Cyclical Ecological Trajectory Analysis
  (CETA)](https://emf-creaf.github.io/ecotraj/articles/IntroductionCETA.md):

### Ecological Quality Assessment

- [Introduction to Ecological Quality Assessment
  (EQA)](https://emf-creaf.github.io/ecotraj/articles/IntroductionEQA.md):
